"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3555],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>m});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=r.createContext({}),l=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},c=function(e){var n=l(e.components);return r.createElement(p.Provider,{value:n},e.children)},f={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=l(t),m=a,g=u["".concat(p,".").concat(m)]||u[m]||f[m]||o;return t?r.createElement(g,i(i({ref:n},c),{},{components:t})):r.createElement(g,i({ref:n},c))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=u;var s={};for(var p in n)hasOwnProperty.call(n,p)&&(s[p]=n[p]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=t[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},732:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>i,default:()=>f,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var r=t(7462),a=(t(7294),t(3905));const o={title:"\u524d\u7aef\u8de8\u57df\u65b9\u6848",date:new Date("2018-09-25T00:00:00.000Z"),categories:"js",tags:["vue","node.js","nginx"]},i=void 0,s={permalink:"/blog/2018/09/25/proxy",source:"@site/blog/2018-09-25-proxy/index.md",title:"\u524d\u7aef\u8de8\u57df\u65b9\u6848",description:"\u505a\u4e86\u4e00\u4efd\u5173\u4e8e\u8de8\u57df\u7684ppt,\u4e3b\u8981\u8bb2\u89e3\u4e86\uff0c\u4f7f\u7528vue-cli\u3001nginx\u3001node.js\u8fdb\u884c\u8de8\u57df\u5904\u7406\u3002\u6b22\u8fce\u4e0b\u8f7d\u89c2\u770b\u3002",date:"2018-09-25T00:00:00.000Z",formattedDate:"2018\u5e749\u670825\u65e5",tags:[{label:"vue",permalink:"/blog/tags/vue"},{label:"node.js",permalink:"/blog/tags/node-js"},{label:"nginx",permalink:"/blog/tags/nginx"}],readingTime:1.685,hasTruncateMarker:!1,authors:[],frontMatter:{title:"\u524d\u7aef\u8de8\u57df\u65b9\u6848",date:"2018-09-25T00:00:00.000Z",categories:"js",tags:["vue","node.js","nginx"]},prevItem:{title:"CSS \u7f51\u683c\u5e03\u5c40(Grid Layout)",permalink:"/blog/2018/10/17/grid"},nextItem:{title:"vue-cli3 + ElementUI",permalink:"/blog/2018/09/03/vue-cli"}},p={authorsImageUrls:[]},l=[],c={toc:l};function f(e){let{components:n,...o}=e;return(0,a.kt)("wrapper",(0,r.Z)({},c,o,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"\u505a\u4e86\u4e00\u4efd\u5173\u4e8e\u8de8\u57df\u7684ppt,\u4e3b\u8981\u8bb2\u89e3\u4e86\uff0c\u4f7f\u7528vue-cli\u3001nginx\u3001node.js\u8fdb\u884c\u8de8\u57df\u5904\u7406\u3002\u6b22\u8fce\u4e0b\u8f7d\u89c2\u770b\u3002"),(0,a.kt)("p",null,(0,a.kt)("a",{target:"_blank",href:t(1479).Z},"PPT\u8bf7\u70b9\u51fb\u8fd9\u91cc\u4e0b\u8f7d")),(0,a.kt)("p",null,"\u4e0b\u9762\u9644\u4e0a\u51e0\u5f20\u7167\u7247\uff0cnode.js\u8de8\u57df\u6e90\u7801\u5728\u4e0b\u9762\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(4724).Z,width:"2838",height:"1414"}),"\n",(0,a.kt)("img",{src:t(2723).Z,width:"2914",height:"1380"}),"\n",(0,a.kt)("img",{src:t(1387).Z,width:"2786",height:"1646"}),"\n",(0,a.kt)("img",{src:t(7601).Z,width:"2982",height:"1730"})),(0,a.kt)("p",null,"proxy.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"var PORT = 3000;\nvar http = require('http');\nvar url=require('url');\nvar fs=require('fs');\nvar mine=require('./mime').types;\nvar path=require('path');\nvar httpProxy = require('http-proxy');\nvar proxy = httpProxy.createProxyServer({\n    target: 'http://192.168.2.18:8080/',   //\u63a5\u53e3\u5730\u5740\n    // \u4e0b\u9762\u7684\u8bbe\u7f6e\u7528\u4e8ehttps\n    // ssl: {\n    //     key: fs.readFileSync('server_decrypt.key', 'utf8'),\n    //     cert: fs.readFileSync('server.crt', 'utf8')\n    // },\n    // secure: false\n});\nproxy.on('error', function(err, req, res){\n    res.writeHead(500, {\n        'content-type': 'text/plain'\n    });\n    console.log(err);\n    res.end('Something went wrong. And we are reporting a custom error message.');\n});\nvar server = http.createServer(function (request, response) {\n    var pathname = url.parse(request.url).pathname;\n    //var realPath = path.join(\"main-pages\", pathname); // \u6307\u5b9a\u6839\u76ee\u5f55\n    var realPath = path.join(\"./\", pathname);\n    console.log(pathname);\n    console.log(realPath);\n    var ext = path.extname(realPath);\n    ext = ext ? ext.slice(1) : 'unknown';\n    //\u5224\u65ad\u5982\u679c\u662f\u63a5\u53e3\u8bbf\u95ee\uff0c\u5219\u901a\u8fc7proxy\u8f6c\u53d1\n    if(pathname.indexOf(\"meis\") > 0){\n        proxy.web(request, response);\n        return;\n    }\n    fs.exists(realPath, function (exists) {\n        if (!exists) {\n            response.writeHead(404, {\n                'Content-Type': 'text/plain'\n            });\n\n            response.write(\"This request URL \" + pathname + \" was not found on this server.\");\n            response.end();\n        } else {\n            fs.readFile(realPath, \"binary\", function (err, file) {\n                if (err) {\n                    response.writeHead(500, {\n                        'Content-Type': 'text/plain'\n                    });\n                    response.end(err);\n                } else {\n                    var contentType = mine[ext] || \"text/plain\";\n                    response.writeHead(200, {\n                        'Content-Type': contentType\n                    });\n                    response.write(file, \"binary\");\n                    response.end();\n                }\n            });\n        }\n    });\n});\nserver.listen(PORT);\nconsole.log(\"Server runing at port: \" + PORT + \".\");\n")),(0,a.kt)("p",null,"mime.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'exports.types = {\n    "css": "text/css",\n    "gif": "image/gif",\n    "html": "text/html",\n    "ico": "image/x-icon",\n    "jpeg": "image/jpeg",\n    "jpg": "image/jpeg",\n    "js": "text/javascript",\n    "json": "application/json",\n    "pdf": "application/pdf",\n    "png": "image/png",\n    "svg": "image/svg+xml",\n    "swf": "application/x-shockwave-flash",\n    "tiff": "image/tiff",\n    "txt": "text/plain",\n    "wav": "audio/x-wav",\n    "wma": "audio/x-ms-wma",\n    "wmv": "video/x-ms-wmv",\n    "xml": "text/xml",\n    "woff": "application/x-woff",\n    "woff2": "application/x-woff2",\n    "tff": "application/x-font-truetype",\n    "otf": "application/x-font-opentype",\n    "eot": "application/vnd.ms-fontobject"\n};\n')))}f.isMDXComponent=!0},1479:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/files/proxy-321296fde307def4387f1fe9f9e8fd0b.pptx"},4724:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/proxy1-e617d4bfa3e9612cf87fb73ea9befeda.png"},2723:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/proxy2-da353710c917be337b2ec69df2484cbf.png"},1387:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/proxy3-e5b363681855a7ed50f0d2d7c4a3d936.png"},7601:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/proxy4-4e21a55d03d2bcaa9997b972a8c2afc0.png"}}]);